function computeMonthlyPayment(a,t,e){var l=0;if(0==e)l=a/t;else{e=e/100/12;for(var n=1,r=0;r<t;r++)n*=1+e;l=a*n*e/(n-1)}return l}function fn(a,t,e){var l=0;a<0&&(a*=-1,l=1);for(var n=1,r=0,o="";r<t;)n*=10,r=Number(r)+Number(1),o+="0";if(onum=Math.round(a*n)/n,integer=Math.floor(onum),Math.ceil(onum)==integer?decimal=o:decimal=Math.round((onum-integer)*n),decimal=decimal.toString(),decimal.length<t)for(fillZeroes=t-decimal.length,z=0;z<fillZeroes;z++)decimal="0"+decimal;if(t>0&&(decimal="."+decimal),1==e){integer=integer.toString();var m="",c="",u=0;for(x=integer.length;x>0;x--)m+=integer.charAt(x-1),3==(u+=1)&x>1&&(m+=",",u=0);for(x=m.length;x>0;x--)c+=m.charAt(x-1);finNum=c+""+decimal}else finNum=integer+""+decimal;return 1==l&&(finNum="-"+finNum),finNum}function sn(a){var t=(a=a.toString()).length,e="",l=a.substring(0,1);for("-"==l&&(e="-"),i=0;i<=t;i++)"0"!=(l=a.substring(i,i+1))&&"1"!=l&&"2"!=l&&"3"!=l&&"4"!=l&&"5"!=l&&"6"!=l&&"7"!=l&&"8"!=l&&"9"!=l&&"."!=l||(e=e+""+l);return""!=e&&"-"!=e||(e=0),e=Number(e)}function computeForm(a){var t=document.calc.closingcosts.value;0!=t&&""!=t||(t=0);var e=sn(parseFloat(document.calc.principal.value)+parseFloat(t)),l=sn(document.calc.intRate.value),n=sn(document.calc.numYears.value),r=document.calc.annualTax.value,o=0;0==r||""==r?(r=0,o=0):(o=(r=sn(r*document.calc.homevalue.value/100))/12,o*=100,o=Math.round(o),o/=100);var m=document.calc.annualInsurance.value,c=0;0==m||""==m?(m=0,c=0):(c=(m=sn(m*document.calc.homevalue.value/100))/12,c*=100,c=Math.round(c),c/=100);var u=document.calc.homevalue.value,i=document.calc.monthlyPMI.value;0==i||""==i||u>1.249999999*e?i=0:(i=sn(i*document.calc.principal.value/100),i/=12,i*=100,i=Math.round(i),i/=100);var s=Number(o)+Number(c)+Number(i),d=computeMonthlyPayment(e,12*n,l),f=Number(d)+Number(s),g=sn(parseFloat(document.calc.homevalue.value)-parseFloat(document.calc.principal.value));document.calc.monthlyPI.value="$"+fn(d,2,1),document.calc.otherPmts.value="$"+fn(s,2,1),document.calc.monthlyPmt.value="$"+fn(f,2,1),document.calc.downpayment.value="$"+fn(g,2,1)}function monthlyAmortSched(a){var t=sn(parseFloat(document.calc.principal.value)+parseFloat(document.calc.closingcosts.value)),e=sn(document.calc.intRate.value),l=sn(document.calc.numYears.value),n=document.calc.annualTax.value,r=0;0==n||""==n?(n=0,r=0):(r=(n=sn(n))/12,r*=100,r=Math.round(r),r/=100);var o=document.calc.annualInsurance.value,m=0;0==o||""==o?(o=0,m=0):(m=(o=sn(o))/12,m*=100,m=Math.round(m),m/=100);var c=document.calc.monthlyPMI.value;c=0==c||""==c?0:sn(c);var u=Number(r)+Number(m)+Number(c),i=12*l,s=computeMonthlyPayment(t,i,e),d=(Number(s),Number(u),t),f=e;f>=1&&(f/=100),f/=12;var g=i,b=0,h=0,v=0,N=0,p=0,y="",M=0,P=new Date,$=P.getTime(),F=P.getDate(),w=P.getMonth()+1,x=P.getYear();x<1900&&(x+=1900);for(var S=w+"/"+F+"/"+x,Y=0,I=0,z=0,A=0;p<g;)if(p<g-1?(b=d*f,b*=100,b=Math.round(b),b/=100,h=Number(h)+Number(b),A=Number(A)+Number(b),v=Number(s)-Number(b),v*=100,v=Math.round(v),v/=100,N=Number(N)+Number(v),z=Number(z)+Number(v),d=Number(d)-Number(v),I=Number(v)+Number(b)):(b=d*f,b*=100,b=Math.round(b),b/=100,h=Number(h)+Number(b),A=Number(A)+Number(b),v=d,N=Number(N)+Number(v),z=Number(z)+Number(v),d=0,I=Number(v)+Number(b)),p=Number(p)+Number(1),M=Number(M)+Number(1),$=Number($)+Number(262656e4),Y=new Date($),pmtMonth=Y.getMonth(),pmtMonth+=1,pmtYear=Y.getYear(),pmtYear<1900&&(pmtYear+=1900),pmtString=pmtMonth+"/"+F+"/"+pmtYear,y+="<tr><td align=right><font face='arial'><small>"+M+"</small></td>",y+="<td align=right><font face='arial'><small>"+pmtString+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(v,2,1)+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(b,2,1)+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(I,2,1)+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(d,2,1)+"</small></td></tr>",12!=pmtMonth&&p!=g||(y+="<tr bgcolor='#dddddd'><td align=right><font face='arial'><small>Total</small></td>",y+="<td align=left><font face='arial'><small>"+pmtYear+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(z,2,1)+"</small></td>",y+="<td align=right><font face='arial'><small>$"+fn(A,2,1)+"</small></td>",y+="<td align=right><font face='arial'><small> </small></td>",y+="<td align=right><font face='arial'><small> </small></td></tr>",z=0,A=0),p>600){alert("Using your current entries you will never pay off this loan.");break}var D="<head><title>Amortization Schedule</title></head>";D+="<body bgcolor= '#FFFFFF'><br /><br /><center><font face='arial'>",D+="<big><strong>Amortization Schedule</strong></big></center>";var T="<center><table border=1 cellpadding=2 cellspacing=0>";T+="<tr><td colspan=6><font face='arial'><small><strong>Loan ",T+="Date: "+S+"<br />Principal: $"+fn(t,2,1)+"<br /># of ",T+="Payments: "+g+"<br />Interest Rate: "+fn(e,3,0)+"%<br />",T+="Payment: $"+fn(s,2,1)+"</strong></small></td></tr><tr><td colspan=6>",T+="<center><font face='arial'><strong>Schedule of Payments</strong><br /><font face='arial'>",T+="<small><small>Please allow for slight rounding differences.</small></small></center></td></tr>",T+="<tr bgcolor='silver'><td align='center'><font face='arial'><small><strong>Pmt #</strong></small></td>",T+="<td align='center'><font face='arial'><small><strong>Date</strong></small></td>",T+="<td align='center'><font face='arial'><small><strong>Principal</strong></small></td>",T+="<td align='center'><font face='arial'><small><strong>Interest</strong></small></td>",T+="<td align='center'><font face='arial'><small><strong>Payment</strong></small></td>",T+="<td align='center'><font face='arial'><small><strong>Balance</strong></small></td></tr>";var W=""+y,R="<tr><td colspan='2'><font face='arial'><small><strong>Grand Total</strong></small></td>";R+="<td align=right><font face='arial'><small><strong>$"+fn(N,2,1)+"</strong></small></td>",R+="<td align=right><font face='arial'><small><strong>$"+fn(h,2,1)+"</strong></small></td>",R+="<td> </td><td> </td></tr></table><br /><center><form method='post'>",R+="<input type='button' value='Close Window' onClick='window.close()'></form>";var k=D+""+T+W+(R+="</center></body></html>");reportWin=window.open("","","width=500,height=400,toolbar=yes,menubar=yes,scrollbars=yes"),reportWin.document.write(k),reportWin.document.close()}function clear_results(a){document.calc.monthlyPI.value="",document.calc.otherPmts.value="",document.calc.monthlyPmt.value=""}