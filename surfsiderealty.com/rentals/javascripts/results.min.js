var bookingFolder="/rentals";function returnTopResults(){var e=$(".booking-header-wrap").outerHeight()+$(".refine-mobile-controls").outerHeight()+50;$("html, body").animate({scrollTop:$("#scrollReturn").position().top-e},800)}function submitForm(){$("#refineForm, #sortForm").find("[name=page]").val(0),$.ajax({type:"POST",url:bookingFolder+"/ajax/results.cfm",data:$("#refineForm, #sortForm").serialize(),beforeSend:function(){$(".results-loader-overlay").fadeIn(200)},success:function(e){var t=function(e){for(var t=e+"=",a=document.cookie.split(";"),r=0;r<a.length;r++){for(var i=a[r];" "==i.charAt(0);)i=i.substring(1);if(-1!=i.indexOf(t))return i.substring(t.length,i.length)}return""}("NUMRESULTS");$("#bottom-result").attr("data-count",t),$(".props-return").text(t),$("#list-all-results").html(e),$(".results-loader-overlay").fadeOut(200);var a=$("#refineForm input[name=strCheckin]").val(),r=$("#refineForm input[name=strCheckout]").val();Math.floor(100*Math.random()+1);""!=a&&""!=r?($(".hidden-sort").show(),$.ajax({type:"POST",url:bookingFolder+"/ajax/get-percentage-booked.cfm",data:$("#refineForm, #sortForm").serialize(),success:function(e){$(".percent-booked-ajax");if(e>50&&t>0){$("#results-list-alert-popular-post").remove();var a=Math.ceil(e);$("#results-list-alert-popular-ajax span.percent-booked-ajax").html(a),$("#results-list-alert-popular-ajax").show()}else $("#results-list-alert-popular-post").remove(),$("#results-list-alert-popular-ajax").hide()}})):$("#results-list-alert-popular-ajax").hide(),$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=serializeCFJSON(e);drawMapAllResults(map,markers,t)},error:function(e,t,a){}})}})}$(document).ready(function(){$(".refine-apply, .refine-close").on("click",function(){$(this).parent().hasClass("refine-dropdown")&&($(this).parent().parent().removeClass("active"),$(this).parent().parent().find(".refine-text").removeClass("active"),$(this).parent().removeClass("active")),$(this).parent().hasClass("refine-filter-action")&&($(this).parent().parent().parent().removeClass("active"),$(this).parent().parent().parent().find(".refine-text").removeClass("active"),$(this).parent().parent().removeClass("active")),$(this).parent().parent().hasClass("refine-filter-box")?$(this).parent().parent().prev().find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up"):$(this).parent().prev().find(".fa-chevron-up").addClass("fa-chevron-down").removeClass("fa-chevron-up")}),$(".refine-text").on("click",function(){$(this).toggleClass("active"),$(this).parent().toggleClass("active"),$(this).next().toggleClass("active"),$(this).find(".fa-chevron").toggleClass("fa-chevron-down").toggleClass("fa-chevron-up")}),$(window).on("load resize",function(e){if($(window).outerWidth()>=1025)$(".refine-dropdown, .refine-filter-box").removeClass("active"),$(".refine-item").removeClass("active"),$(".refine-text").removeClass("active"),$(".refine-text").find(".fa-chevron").removeClass("fa-chevron-up").addClass("fa-chevron-down"),$(".refine-text").on("click",function(){$(this).parent().siblings().removeClass("active"),$(this).parent().siblings().find(".refine-dropdown").removeClass("active"),$(this).parent().siblings().find(".fa-chevron").removeClass("fa-chevron-up").addClass("fa-chevron-down")}),$(document).on("click",function(e){$(e.target).is(".refine-text, .refine-text *, .refine-dropdown, .refine-dropdown *, .refine-filter-box, .refine-filter-box *, .ui-datepicker-next, .ui-datepicker-prev")?e.stopPropagation():($(".refine-dropdown, .refine-filter-box").removeClass("active"),$(".refine-item").removeClass("active"),$(".refine-text").removeClass("active"),$(".refine-text").find(".fa-chevron").removeClass("fa-chevron-up").addClass("fa-chevron-down"))});else{function t(){$(window).scrollTop()>$("#refineAnchor").offset().top?($("#refineForm").addClass("fixed"),$("#refineControls").addClass("fixed"),$("#refineAnchor").height($("#refineControls").outerHeight())):($("#refineForm").removeClass("fixed"),$("#refineControls").removeClass("fixed"),$("#refineAnchor").height(0))}$(function(){$(window).scroll(t),t()})}});var e=1;if($(window).width()>768)e=[1,2];else e=1;var t=new Date,a=$("#startDateRefine").val();function r(e,t,a,r){var i=new google.maps.InfoWindow({size:new google.maps.Size(150,50)}),s=new OverlappingMarkerSpiderfier(e,{markersWontMove:!0,markersWontHide:!0,basicFormatEvents:!0,keepSpiderfied:!0,circleSpiralSwitchover:"Infinity"});if(t.length)for(var o=t.length-1;o>=0;o--)t[o].setMap(null),t[o]=null,t.splice(o,1);var n=new google.maps.LatLngBounds;if(a.length)for(o=0;o<a.length;o++){var l=a[o];if(null!=l.latitude){f=new google.maps.LatLng(l.latitude,l.longitude);function d(e){google.maps.event.addListener(e,"mouseover",function(){var t={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),google.maps.event.addListener(e,"mouseout",function(){var t={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),$(".results-list-property").mouseover(function(){var e=$(this).attr("data-mapMarkerID"),a={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};t[e].setIcon(a),t[e].setZIndex(100)}),$(".results-list-property").mouseout(function(){var e=$(this).attr("data-mapMarkerID"),a={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};t[e].setIcon(a),t[e].setZIndex(1)})}!function(t,a){var r='<a href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank"><img src="'+t.mapphoto+'" width="180" height="100" /></a><h4><a href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank">'+t.unitshortname+"</a></h4><strong>"+t.bedrooms+" BR | Sleeps "+t.maxoccupancy+" | "+t.bathrooms+' Baths</strong><br><a class="btn btn-mini site-color-1-bg site-color-1-lighten-bg-hover text-white" href="'+bookingFolder+"/"+t.seopropertyname+'" target="_blank">Learn More</a>';google.maps.event.addListener(a,"spider_click",function(){i.setContent(r),i.open(e,a)}),google.maps.event.addListener(e,"spider_click",function(){i.close()}),s.addMarker(a)}(l,c=new google.maps.Marker({map:e,position:new google.maps.LatLng(l.latitude,l.longitude),icon:bookingFolder+"/images/marker.png",zIndex:1})),d(c),t.push(c),n.extend(f)}}else{var c,f=new google.maps.LatLng(33.8994,-78.47126);function d(e){google.maps.event.addListener(e,"mouseover",function(){var t={url:bookingFolder+"/images/marker-hover.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)}),google.maps.event.addListener(e,"mouseout",function(){var t={url:bookingFolder+"/images/marker.png",scaledSize:new google.maps.Size(28,39)};e.setIcon(t)})}!function(t,a){google.maps.event.addListener(a,"click",function(){i.setContent('<a href="/contact/" target="_blank"><h4 style="margin-top:0">Our Office</h4></a>UPDATE CLIENT ADDRESS HERE'),i.open(e,a)}),google.maps.event.addListener(e,"click",function(){i.close()})}(0,c=new google.maps.Marker({map:e,position:new google.maps.LatLng(33.8994,-78.47126),icon:bookingFolder+"/images/marker.png",zIndex:1})),n.extend(f),d(c),n.extend(f)}e.fitBounds(n),setTimeout(function(){$("#map-all-results img[src^=data]:not([alt])").length&&$("#map-all-results img[src^=data]:not([alt])").attr("alt","")},2e3)}$.datepicker.setDefaults({dateFormat:"mm/dd/yy",minDate:t}),$("#refineDatepicker").datepicker({defaultDate:a,numberOfMonths:e,beforeShowDay:function(e){var t=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#startDateRefine").val()),a=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#endDateRefine").val()),r=t&&(e.getTime()==t.getTime()||a&&e>=t&&e<=a);return 6==e.getDay()?[!0,r?"dp-highlight":""]:[!1]},onSelect:function(e,t){var a=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#startDateRefine").val()),r=$.datepicker.parseDate($.datepicker._defaults.dateFormat,$("#endDateRefine").val()),i=$.datepicker.parseDate($.datepicker._defaults.dateFormat,e);!a||r?($("#startDateRefine").val(e).addClass("date-entered"),$("#endDateRefine").val("").addClass("date-entered"),console.log("Start Date Entered")):i<a?($("#endDateRefine").val($("#startDateRefine").val()),$("#startDateRefine").val(e),console.log("You are going Backwards!")):($("#endDateRefine").val(e),console.log("End Date Entered"))}}),$(document).on("click",".refine-clear",function(){$("#refineDatepicker").datepicker("refresh"),$("#refineDatepicker").datepicker("setDate",new Date),$("#startDateRefine").val("").removeClass("date-entered").datepicker("refresh"),$("#endDateRefine").val("").removeClass("date-entered").datepicker("refresh"),$(".ui-datepicker-calendar td").removeClass("dp-highlight"),$(this).parent().siblings().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down"),submitForm()}),$(".refine-counter").each(function(){var e=$(this).parent().find(".refine-count"),t=$(this).parent().find(".refine-drop-count"),a=e.text(),r=$(this).find(".refine-drop-count").data("min"),i=$(this).find(".refine-drop-count").data("max"),s=a;a>r&&$(this).find(".fa-minus").removeClass("disabled"),$(this).find(".fa-plus").on("click",function(){s>=r&&s<i&&(s++,e.text(s),t.text(s),$(this).prev().prev().removeClass("disabled")),s===i&&$(this).addClass("disabled")}),$(this).find(".fa-minus").on("click",function(){s<=i&&s>r&&(--s,e.text(s),t.text(s),$(this).next().next().removeClass("disabled")),s===r&&$(this).addClass("disabled")})}),$(document).on("click","#refineDatesApply",function(){submitForm(),returnTopResults()}),$(document).on("click","#refineMoreFiltersApply",function(){var e=$(".refine-filter-checkbox[type=checkbox]:checked").length;$("#filtersCount").text("("+e+")"),submitForm(),returnTopResults()}),$("#refineApplyAll").on("click",function(){$("body").removeClass("refine-open");var e=$(".refine-guests .refine-count").text();$("input[name=sleeps]").val(e),console.log("guestCount: "+e);var t=$(".refine-filter-checkbox[type=checkbox]:checked").length;$("#filtersCount").text("("+t+")"),submitForm()}),$(".refine-apply-all").on("click",function(){$("#viewFiltersMobile").html('<i class="fa fa-toggle-off site-color-1" aria-hidden="true"></i> <span class="site-color-1">Refine Your Search</span>'),$(".refine-form").addClass("mobile-hidden"),returnTopResults()}),window.map=new google.maps.Map(document.getElementById("map"),{zoom:14,maxZoom:18,mapTypeId:google.maps.MapTypeId.street}),window.markers=[],$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=s(e);r(map,markers,t)},error:function(e,t,a){}}),window.drawMapAllResults=r,window.serializeCFJSON=s;var i=!1;function s(e){for(var t=[],a=0;a<e.DATA.length;a++){for(var r={},i=e.DATA[a],s=0;s<e.COLUMNS.length;s++)r[e.COLUMNS[s].toLowerCase()]=i[s];t.push(r)}return t}$(window).on("scroll",function(e){var t=$("#bottom-result"),a=$("#refineForm, #sortForm"),r=t.offset().top;if($(window).scrollTop()+$(window).height()>r){var s=parseInt(t.attr("data-count")),o=parseInt(a.find("[name=page]").val());o+1<Math.ceil(s/12)&&!i&&(t.addClass("loading"),i=!0,a.find("[name=page]").val(o+1),$.ajax({type:"POST",url:bookingFolder+"/ajax/results.cfm?scroll",data:a.serialize(),success:function(e){setTimeout(function(){$("#list-all-results").append(e),t.removeClass("loading"),i=!1,console.log("This is from the infinite scroll ajax")},500)}}))}}),$(".refine-filter-see-all").on("click",function(){$(this).prev().toggleClass("hidden"),$(this).find(".fa").toggleClass("fa-chevron-down").toggleClass("fa-chevron-up")}),$(".refine-filter-select-all").on("click",function(){var e=$(this).closest(".refine-filter-section").find(".refine-filter-checkbox"),t=$(this).prop("checked");e.prop("checked",t),$(this).next().text("Deselect All"==$(this).next().text()?"Select All":"Deselect All")}),$(".refine-filter-checkbox").on("click",function(){var e=$(this).closest(".refine-filter-section").find(".refine-filter-checkbox"),t=$(this).closest(".refine-filter-section").find(".refine-filter-select-all"),a=$(this).closest(".refine-filter-section").find(".select-all");!$(e).filter(":checked").length>0&&($(t).prop("checked",!1),$(a).text("Select All")),$(e).filter(":checked").length==$(e).length?($(t).prop("checked",!0),$(a).text("Deselect All")):($(t).prop("checked",!1),$(a).text("Select All"))}),$(".refine-filter-specific-property-select").change(function(){var e=$(this).val();window.open(e,"_blank").location}),$("#sortForm").on("click",function(e){e.stopPropagation(),$(this).find("ul").toggleClass("hidden")}),$("#sortForm ul li").on("click",function(){var e=$(this).find("span").text();$("#resultsListSortTitle i").text(e);var t=$(this).attr("data-resultsList");$("#refineForm").find("input[name=strSortBy]").val(t),submitForm()}),$("#viewListAndMap").on("click",function(){$(".results-list-wrap").hasClass("results-list-full-width")?$(this).html('<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>'==$(this).html()?'<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>':'<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>'):$(this).html('<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>'==$(this).html()?'<i class="fa fa-th-large site-color-1" aria-hidden="true"></i><span class="site-color-1">Grid View</span>':'<i class="fa fa-columns site-color-1" aria-hidden="true"></i><span class="site-color-1">Split View</span>'),$(".results-list-wrap").toggleClass("results-list-full-width").removeClass("hidden"),$(".map-wrap").toggleClass("hidden").removeClass("map-wrap-full"),setTimeout(function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)},500)}),$("#viewMapOnly").on("click",function(){var e;($(".results-list-wrap").toggleClass("hidden").removeClass("results-list-full-width"),$(".map-wrap").toggleClass("map-wrap-full").removeClass("hidden"),$("#viewListAndMap").toggleClass("inactive"),!$(".results-list-wrap").hasClass("results-list-full-width")||$(".map-wrap").hasClass("map-wrap-full")?$("#viewListAndMap").children("i").addClass("fa-th-large").removeClass("fa-columns"):$(".results-list-wrap").hasClass("results-list-full-width")?$("#viewListAndMap").children("i").addClass("fa-columns").removeClass("fa-th-large"):$("#viewListAndMap").children("i").addClass("fa-th-large").removeClass("fa-columns"),$(window).width()<1200&&('<a href="javascript:;" id="viewFiltersMobile" rel="tooltip" data-placement="bottom" title="" data-original-title="Refine Your Search"><i class="fa site-color-1 fa-toggle-on" aria-hidden="true"></i> <span class="site-color-1">Close Refine</span></a>'===$("#viewFiltersMobile").html()?$("#viewFiltersMobile").html('<i class="fa site-color-1 fa-toggle-on" aria-hidden="true"></i> <span class="site-color-1">Close Refine</span>'):$("#viewFiltersMobile").html('<i class="fa fa-toggle-off site-color-1" aria-hidden="true"></i> <span class="site-color-1">Refine Your Search</span>'),$(".refine-form").addClass("mobile-hidden")),$(window).width()>1025&&$(window).width()<1200)&&("Map View"===(e=$(this).find("span")).text()?(e.text("Split View"),$(this).children("i").addClass("fa-columns").removeClass("fa-map-marker")):(e.text("Map View"),$(this).children("i").addClass("fa-map-marker").removeClass("fa-columns")));$(window).width()<1024&&("Map View"===(e=$(this).find("span")).text()?(e.text("Grid View"),$(this).children("i").addClass("fa-th-large").removeClass("fa-map-marker")):(e.text("Map View"),$(this).children("i").addClass("fa-map-marker").removeClass("fa-th-large")));$(window).width()<736&&$(".booking-footer-wrap").toggleClass("hidden"),setTimeout(function(){$.ajax({type:"POST",url:bookingFolder+"/ajax/map-all-results.cfm",data:$("#refineForm, #sortForm").serialize(),dataType:"json",success:function(e){var t=s(e);r(map,markers,t)},error:function(e,t,a){}});var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)},500),console.log("map btn has been clicked")}),$("#viewFiltersMobile").on("click",function(){$("body").toggleClass("refine-open");var e=$(this).find("span");"Refine Your Search"===e.text()?(e.text("Close Refine"),$(this).children("i").addClass("fa-toggle-on").removeClass("fa-toggle-off")):(e.text("Refine Your Search"),$(this).children("i").addClass("fa-toggle-off").removeClass("fa-toggle-on")),$(".refine-form").toggleClass("mobile-hidden"),$(".refine-item").addClass("active"),$(".refine-text").addClass("active"),$(".refine-text").find(".fa-chevron").addClass("fa-chevron-up").removeClass("fa-chevron-down"),$(".refine-dropdown, .refine-filter-box").addClass("active")}),$(".results-list-property-img-wrap").on("click",".results-list-property-special",function(){var e=$(this).parent().find(".special-modal-content").html();$("#specialModalContent").html(e)})});